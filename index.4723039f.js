var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},r=e.parcelRequired7c6;null==r&&((r=function(e){if(e in t)return t[e].exports;if(e in a){var r=a[e];delete a[e];var n={id:e,exports:{}};return t[e]=n,r.call(n.exports,n,n.exports),n.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){a[e]=t},e.parcelRequired7c6=r),r.register;var n=(r("krGWQ"),r("krGWQ"));const{API_KEY:i,BASE_URL_ALL:s,BASE_URL_GENRE:l,cards:o}=n.default;async function c(e=1){o.classList.add("loader");try{let t=await fetch(`${s}?api_key=${i}&page=${e}`);if(!t.ok)throw Error(t.statusText);let a=await t.json(),r=await Promise.all(a.results.map(async e=>{try{let t=await fetch(`${l}${e.id}?api_key=${i}&include_image_language=en,null`);if(!t.ok)throw Error(t.statusText);return await t.json()}catch(e){console.log("Error fetching genre information:",e)}}));return o.classList.remove("loader"),r}catch(e){console.log("Error fetching all movies:",e)}}var n=r("krGWQ");const{cards:u}=n.default;async function d(e){try{let t=e.filter(e=>{if(e&&null!==e.poster_path)return e}).map(({title:e,poster_path:t,genres:a,release_date:r,id:n})=>{let i=a.map(e=>e.name).join(", "),s=r.slice(0,4);return`
              <li class="page-item" data-id="${n}">
                 <a href="#" class="page-item__link">
                 <img src="https://image.tmdb.org/t/p/w500${t}">
                 <div class="page-description">
                     <h2 class="page-description__title">${e}</h2>
                     <p class="page-description__podscription">${i} <span>| ${s}</span></p>
                 </div>
                 </a>
              </li>`}).join(" ");u.insertAdjacentHTML("beforeend",t)}catch(e){console.log(e)}}var n=r("krGWQ"),g=r("1GAPJ"),n=r("krGWQ");const{cards:p}=n.default;function f(){p.innerHTML=""}var h=r("9Uhgk");const{formSubmit:m,BASE_URL_QUERY:_,API_KEY:y,BASE_URL_GENRE:w,cards:P,pagination:$}=n.default;(0,h.default)();var n=r("krGWQ");const{API_KEY:E,BASE_URL_ALL:v,arrowRight:L,arrowLeft:k}=n.default,b={totalPageCount:0,currentPage:1,maxPageBtn:9,nearEdgeThreshold:3,pageNumbersHtml:document.querySelector(".js-list")};async function C(e=1){let t=await fetch(`${v}?api_key=${E}&page=${e}`),a=await t.json();b.totalPageCount=a.total_pages,b.currentPage=e;let r=[];if(b.totalPageCount<=b.maxPageBtn)for(let e=1;e<=b.totalPageCount;e++)r.push(e);else if(b.currentPage<=b.nearEdgeThreshold+1){for(let e=1;e<=b.maxPageBtn-2;e+=1)r.push(e);r.push("..."),r.push(b.totalPageCount)}else if(b.currentPage>=b.totalPageCount-b.nearEdgeThreshold){r.push(1),r.push("...");for(let e=b.totalPageCount-b.maxPageBtn+3;e<=b.totalPageCount;e+=1)r.push(e)}else{r.push(1),r.push("...");for(let e=b.currentPage-b.nearEdgeThreshold;e<=b.currentPage+b.nearEdgeThreshold;e+=1)r.push(e);r.push("..."),r.push(b.totalPageCount)}let n=r.map(e=>{if("..."===e)return`<span>${e}</span>`;{let t=b.currentPage===e?"isactive":"";return`<button class="js-page-number ${t}" data-page="${e}">${e}</button>`}}).join("");b.pageNumbersHtml.innerHTML=n,L.disabled=b.currentPage===b.totalPageCount,k.disabled=1===b.currentPage}async function j(e){console.log("Запрашиваем страницу номер:",e),f(),d(await c(e)),C(e)}document.querySelector(".js-list").addEventListener("click",async e=>{let t=e.target.closest(".js-page-number");if(t){let e=parseInt(t.dataset.page);isNaN(e)||await j(e)}}),L.addEventListener("click",async()=>{if(b.currentPage<b.totalPageCount){let e=b.currentPage+1;await j(e)}}),k.addEventListener("click",async()=>{if(b.currentPage>1){let e=b.currentPage-1;await j(e)}});var A=r("4aAp5");let T=1;const{arrowRight:R,arrowLeft:N}=n.default;!async function(){let e=await c(T);await d(e),C()}();const{handleLeftClick:x,handleRightClick:B}={handleRightClick:async()=>{T+=1;try{f();let e=await c(T);d(e),C(T)}catch(e){console.error(e)}},handleLeftClick:async()=>{T-=1;try{f();let e=await c(T);d(e),C(T)}catch(e){console.error(e)}}};N.addEventListener("click",x),R.addEventListener("click",B),m.addEventListener("submit",async e=>{e.preventDefault();let t=e.currentTarget.serchQuary.value.trim();if(!t){(0,g.Notify).info("You have not entered anything");return}P.classList.add("loader");try{let e=await fetch(`${_}?api_key=${y}&query=${t}`),a=await e.json();if(0===a.total_pages||0===a.total_results){(0,g.Notify).info("Nothing found for your request");return}{let e=await a.results.filter(e=>{if(e&&null!==e.poster_path)return e}),t=await e.map(({id:e})=>e),r=await Promise.all(t.map(async e=>{let t=await fetch(`${w}${e}?api_key=${y}`),{title:a,poster_path:r,release_date:n,genres:i}=await t.json(),s=i.map(({name:e})=>e).join(" "),l=n.slice(0,4);return`
              <li class="page-item" data-id="${e}">
                  <a href="#" class="page-item__link">
                      <img class="page-item__img" src="https://image.tmdb.org/t/p/w500${r}" alt="${a}"/>
                      <div class="page-description">
                          <h2 class="page-description__title">${a}</h2>
                          <p class="page-description__podscription">${s} ${l}</p>
                      </div>
                  </a>
              </li>`}));(0,g.Notify).success(`According to your request
      found ${a.results.length} films`),f(),$.style.display="none",P.innerHTML=r.join(" ")}}catch(e){console.error("An error occurred while delivering data",console.error())}finally{P.classList.remove("loader")}}),(0,A.default)();
//# sourceMappingURL=index.4723039f.js.map
